# -*- mode: shell-script -*-
#!/bin/bash

function usage () {
    echo "$1"
    exit
}

# get homebrew
if test ! $(which brew); then
    echo "Installing homebrew..."
    ruby -e "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)"
fi

# Install stuff
brew update

brew install \
     aspell bash bash-completion cask coreutils curl emacs erlang findutils \
     git grep htop jq make mosh pstree rebar3 shellcheck tmux wget
brew cask install \
     chromium docker emacs firefox google-chrome slack spotify tunnelblick xquartz

# link some nice stuff
ULB=/usr/local/bin
[ -x $ULB/find ] || ln -s $(brew --prefix findutils)/bin/gfind $ULB/find
[ -x $ULB/xargs ] || ln -s $(brew --prefix findutils)/bin/gxargs $ULB/xargs
[ -x $ULB/grep ] || ln -s $(brew --prefix grep)/bin/ggrep $ULB/grep

ssh-keygen
# upload key to github

# get my stuff
(cd /tmp && git clone git@github.com:massemanet/dotfiles.mac.git)
mv /tmp/dotfiles.mac/.git ~
git reset --hard
(cd ~/.emacs.d && cask install)
for e in ~/.emacs.d/.cask/*/elpa/edts-* ; do (cd $e && pwd && make) ; done
