#!/bin/bash

Exit() {
    echo $*
    exit
}

[ -z "$1" ] && Exit "usage: $1 <package>"
[ -d /tmp/$1 ] || Exit no_source_dir
PACK=$1

WILD_BALL=/tmp/$PACK/$PACK*.tar.gz
[ $WILD_BALL != "$WILD_BALL" ] && rm $WILD_BALL
make -C /tmp/$PACK dist || Exit not_disting
REV=`echo $WILD_BALL | grep -Eo "\-[0-9.]+.tar.gz" | grep -Eo "[0-9].[0-9]+"`
[ -d /tmp/$PACK-$REV ] && rm -rf /tmp/$PACK-$REV
tar -xzf /tmp/$PACK/$PACK-$REV.tar.gz -C /tmp/

cd /tmp/$PACK-$REV && \
./configure --prefix=/usr/local && \
make && \
sudo make -C /tmp/$PACK-$REV/ install
