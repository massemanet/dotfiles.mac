#!/bin/bash
repo_base=svn+ssh://svn@svn.hq.kred/kreditor
tmp=`mktemp -d /tmp/kext_XX`

svn co $repo_base/$proj/vendor/current $tmp
find $tmp -type f -name "[a-zA-Z]*" | grep -v ".svn" | xargs rm
svn export --force https://$proj.googlecode.com/svn/tags/$tag $tmp
svn ci $tmp -m"vendor drop $tag"
rm -rf $tmp

svn cp $repo_base/$proj/vendor/current $repo_base/$proj/vendor/$tag \
    -m"tagging vendor drop $tag"

svn co $repo_base/$proj/trunk $tmp
svn merge $repo_base/$proj/vendor/current $tmp
svn ci $tmp -m"upgraded to $proj $tag from googlecode"

